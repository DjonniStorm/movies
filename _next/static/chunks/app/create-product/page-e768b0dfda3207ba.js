(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[61],{375:(e,r,s)=>{"use strict";s.d(r,{ProductForm:()=>m});var t=s(5155),o=s(1368),i=s(221),n=s(2177),a=s(5594),l=s(2768),c=s(1443);let d=a.z.object({name:a.z.string({message:"Необходимо название фильма"}),year:a.z.string().refine(e=>Number.isFinite(+e),{message:"Необходимо число"}).refine(e=>+e>=1895,{message:"Фильмы тогда не выпускали"}).refine(e=>2077>=+e,{message:"Многовато"}),description:a.z.string({message:"ну не очень много написать надо"}).min(10,"Интересный фильм )").max(1e3,"Хорошая получилась история @Макс Лавров"),cover:a.z.string({message:"нужна ссылка"}).url({message:"это не url"}),shortDescription:a.z.string({message:"Необходима аннотация"}).min(5,"Ну немного хотя бы").max(500,"Переборщил"),ageRating:a.z.string().refine(e=>Number.isFinite(+e),{message:"Необходимо число"}).refine(e=>21>=+e,{message:"Слишком жёсткий для сервиса"}).refine(e=>+e>=0,{message:"По приколу"})}),m=()=>{let{addItem:e}=(0,c.s)(),{register:r,handleSubmit:s,formState:{errors:a,isSubmitting:m},reset:u}=(0,n.mN)({resolver:(0,i.u)(d)}),p=async r=>{if(Object.keys(a).length){console.warn(a);return}e({name:r.name,year:+r.year,description:r.description,shortDescription:r.shortDescription,ageRating:+r.ageRating,id:(0,o.A)(),poster:{url:r.cover,previewUrl:r.cover},like:!1}),await new Promise(e=>{setTimeout(e,1e3)}),u()};return(0,t.jsxs)("form",{onSubmit:s(p),className:"flex flex-col w-11/12 md:w-5/12 bg-primary/10 border border-secondary rounded-xl p-2 md:p-10 gap-1 md:gap-5 items-center justify-center",children:[(0,t.jsxs)("label",{className:"flex flex-col w-10/12",children:[(0,t.jsx)("span",{children:"Введите название"}),(0,t.jsx)("input",{className:"border border-secondary rounded p-2 focus:outline-none focus:ring-2 focus:ring-blue-200 focus:border-secondary placeholder:text-secondary",type:"text",placeholder:"название",autoComplete:"name",required:!0,...r("name")}),a.name&&(0,t.jsx)("span",{className:"text-red-600 text-center",children:a.name.message})]}),(0,t.jsxs)("label",{className:"flex flex-col w-10/12",children:[(0,t.jsx)("span",{children:"Введите год выхода"}),(0,t.jsx)("input",{type:"number",...r("year"),placeholder:"год выхода",required:!0,className:"border border-secondary rounded p-2 focus:outline-none focus:ring-2 focus:ring-blue-200 focus:border-secondary placeholder:text-secondary"}),a.year&&(0,t.jsx)("span",{className:"text-red-600 text-center",children:a.year.message})]}),(0,t.jsxs)("label",{className:"flex flex-col w-10/12",children:[(0,t.jsx)("span",{children:"Введите возрастной рейтинг"}),(0,t.jsx)("input",{type:"number",...r("ageRating"),placeholder:"возрастной рейтинг",required:!0,className:"border border-secondary rounded p-2 focus:outline-none focus:ring-2 focus:ring-blue-200 focus:border-secondary placeholder:text-secondary"}),a.ageRating&&(0,t.jsx)("span",{className:"text-red-600 text-center",children:a.ageRating.message})]}),(0,t.jsxs)("label",{className:"flex flex-col w-10/12",children:[(0,t.jsx)("span",{children:"Введите ссылку на обложку"}),(0,t.jsx)("input",{type:"url",...r("cover"),placeholder:"ссылка на картинку",required:!0,className:"border border-secondary rounded p-2 focus:outline-none focus:ring-2 focus:ring-blue-200 focus:border-secondary placeholder:text-secondary"}),a.cover&&(0,t.jsx)("span",{className:"text-red-600 text-center",children:a.cover.message})]}),(0,t.jsxs)("label",{className:"flex flex-col w-10/12",children:[(0,t.jsx)("span",{children:"Введите аннотацию"}),(0,t.jsx)("textarea",{...r("shortDescription"),placeholder:"аннотация",className:"resize-none h-14 border border-secondary rounded p-2 focus:outline-none focus:ring-2 focus:ring-blue-200 focus:border-secondary placeholder:text-secondary",spellCheck:!0,required:!0}),a.shortDescription&&(0,t.jsx)("span",{className:"text-red-600 text-center",children:a.shortDescription.message})]}),(0,t.jsxs)("label",{className:"flex flex-col w-10/12",children:[(0,t.jsx)("span",{children:"Введите описание"}),(0,t.jsx)("textarea",{placeholder:"описание",...r("description"),spellCheck:!0,required:!0,className:"resize-none h-20 border border-secondary rounded p-2 focus:outline-none focus:ring-2 focus:ring-blue-200 focus:border-secondary placeholder:text-secondary"}),a.description&&(0,t.jsx)("span",{className:"text-red-600 text-center",children:a.description.message})]}),(0,t.jsxs)(l.$,{type:"submit",disabled:m,className:"text-sm md:text-xl p-2 md:p-5",children:[m&&(0,t.jsx)("span",{children:"Добавляется..."}),!m&&(0,t.jsx)("span",{children:"Добавить фильм"})]})]})}},1443:(e,r,s)=>{"use strict";s.d(r,{s:()=>c});var t=s(5594);let o=t.z.object({id:t.z.number().transform(e=>e.toString()),name:t.z.string(),type:t.z.string().optional(),year:t.z.number(),description:t.z.string(),shortDescription:t.z.string(),ageRating:t.z.number(),poster:t.z.object({url:t.z.string(),previewUrl:t.z.string()})}),i=t.z.array(o),n=async()=>{try{let s=await fetch("https://api.kinopoisk.dev/v1.4/movie?page=1&limit=20&selectFields=id&selectFields=name&selectFields=description&selectFields=shortDescription&selectFields=year&selectFields=ageRating&selectFields=poster&notNullFields=id&notNullFields=name&notNullFields=description&notNullFields=shortDescription&notNullFields=year&notNullFields=ageRating&notNullFields=poster.url&type=movie",{method:"GET",headers:{"X-API-KEY":"N7T5YSR-B664H27-GVZXW2V-QF0NHT5"},next:{revalidate:1e3}});if(!s.ok)throw Error("Failed to fetch movies");let t=await s.json(),o=i.safeParse(t.docs);if(!o.success){var e,r;throw console.warn(null===(e=o.error)||void 0===e?void 0:e.issues),Error("Failed to parse movies schema: ".concat(JSON.stringify(null===(r=o.error)||void 0===r?void 0:r.issues)))}return console.log(t.docs),t.docs}catch(e){if(console.warn(e),e instanceof Error)throw Error(e.message);throw Error("хз что")}};var a=s(5453),l=s(6786);let c=(0,a.v)()((0,l.lt)((e,r)=>({moviesItems:[],isLoading:!0,isError:!1,isFilter:!1,setFilter:r=>{e(e=>({...e,isFilter:r}))},addItems:async()=>{try{let r=await n();if(r instanceof Error)throw r;let s=r.map(e=>({...e,like:!1,id:e.id.toString()}));e(e=>({...e,moviesItems:s,isLoading:!1}))}catch(r){console.warn(r),e(e=>({...e,isError:!0,isLoading:!1}))}},getItem:e=>r().moviesItems.find(r=>(console.log(e,typeof e,r.id,typeof r.id,e===r.id),r.id===String(e))),addItem:r=>{e(e=>({...e,moviesItems:[...e.moviesItems,r]}))},reactItem:(s,t)=>{let o=r().moviesItems,i=o.find(e=>e.id===s);if(console.log(i,typeof s),o.find(e=>(console.log(e.id,e.id===s,e.id===String(s),String(s)),e.id===s)),i){if("dislike"===t){e(e=>({...e,moviesItems:o.filter(e=>e.id!==i.id)}));return}"like"===t&&e(e=>({...e,moviesItems:o.map(e=>(e.id===i.id&&(e.like=!0),e))}))}}})))},2768:(e,r,s)=>{"use strict";s.d(r,{$:()=>i});var t=s(5155),o=s(9434);let i=e=>{let{type:r,onClick:s,children:i,className:n="",...a}=e;return(0,t.jsx)("button",{onClick:s,type:r,className:(0,o.cn)("max-w-60 w-fit rounded-2xl text-xl bg-primary border-2 border-secondary p-5 hover:bg-primary/10 active:hover:bg-primary/10",n),...a,children:i})}},3158:(e,r,s)=>{"use strict";s.d(r,{ReturnComponent:()=>n});var t=s(5155),o=s(5695);s(2115);var i=s(2768);let n=()=>{let e=(0,o.useRouter)();return(0,t.jsx)(i.$,{onClick:()=>{e.push("/products")},type:"button",className:"absolute left-10 top-10 z-2",children:"Назад"})}},9322:(e,r,s)=>{Promise.resolve().then(s.bind(s,375)),Promise.resolve().then(s.bind(s,3158))},9434:(e,r,s)=>{"use strict";s.d(r,{cn:()=>i});var t=s(2596),o=s(9688);let i=function(){for(var e=arguments.length,r=Array(e),s=0;s<e;s++)r[s]=arguments[s];return(0,o.QP)((0,t.$)(r))}}},e=>{var r=r=>e(e.s=r);e.O(0,[109,226,441,684,358],()=>r(9322)),_N_E=e.O()}]);